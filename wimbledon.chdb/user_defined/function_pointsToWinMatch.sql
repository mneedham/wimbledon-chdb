CREATE FUNCTION pointsToWinMatch AS (bestOf5, MatchWinner, GameWinner, SetWinner, whoAmI, mySetScore, theirSetScore, myGameScore, theirGameScore, myPointScore, theirPointScore) -> multiIf(MatchWinner = whoAmI, 0, MatchWinner = '0', (if(bestOf5, pointsToWinOtherSetsBO5(CAST(mySetScore, 'UInt32'), NOT (SetWinner != '0')), pointsToWinOtherSetsBO3(CAST(mySetScore, 'UInt32'), NOT (SetWinner != '0'))) + multiIf(SetWinner != '0', 0, (myGameScore = '6') AND (theirGameScore = '6') AND (((mySetScore = '2') AND (theirSetScore = '2') AND bestOf5) OR ((mySetScore = '1') AND (theirSetScore = '1') AND (NOT bestOf5))), pointsToWinFinalSet(CAST(myGameScore, 'UInt32'), CAST(theirGameScore, 'UInt32'), NOT ((GameWinner != '0') OR (SetWinner != '0'))), pointsToWinSet(CAST(myGameScore, 'UInt32'), CAST(theirGameScore, 'UInt32'), NOT ((MatchWinner != '0') OR (SetWinner != '0') OR (GameWinner != '0'))))) + multiIf(GameWinner != '0', 0, (myGameScore = '6') AND (theirGameScore = '6') AND (((mySetScore = '2') AND (theirSetScore = '2') AND bestOf5) OR ((mySetScore = '1') AND (theirSetScore = '1') AND (NOT bestOf5))), pointsToWinMatchTiebreak(CAST(myPointScore, 'UInt32'), CAST(theirPointScore, 'UInt32')), (myGameScore = '6') AND (theirGameScore = '6'), pointsToWinTiebreak(CAST(myPointScore, 'UInt32'), CAST(theirPointScore, 'UInt32')), pointsToWinGame(myPointScore, theirPointScore)), if(bestOf5, 72, 48))
