CREATE FUNCTION pointsToWinGame AS (p1Score, p2Score) -> multiIf((p1Score = '40') AND (p2Score = 'AD'), 3, (p1Score = '40') AND (p2Score = '40'), 2, (p1Score = '40') AND ((p2Score = '0') OR (p2Score = '15') OR (p2Score = '30')), 1, (p1Score = '30') AND ((p2Score = '0') OR (p2Score = '15') OR (p2Score = '30')), 2, (p1Score = '30') AND (p2Score = '40'), 3, (p1Score = '15') AND ((p2Score = '0') OR (p2Score = '15') OR (p2Score = '30')), 3, (p1Score = '15') AND (p2Score = '40'), 4, (p1Score = '0') AND ((p2Score = '0') OR (p2Score = '15') OR (p2Score = '30')), 4, (p1Score = '0') AND (p2Score = '40'), 5, p1Score = 'AD', 1, 0)
